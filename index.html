<!doctype html>
<html>
  <head>
    <meta charset = "UTF-8">
    <script src='https://cdn.firebase.com/js/client/2.2.1/firebase.js'></script>
    <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
    <link rel='stylesheet' type='text/css' href='/resources/tutorial/css/example.css'>
  </head>
  <body>
    <div id='notesDiv'></div>
    <input type='text' id='noteTitle' placeholder='Note Title'>
    <input type='text' id='noteTask' placeholder='Note Description'>
    <button type='button' id='submitButton'>Submit!</button>
    <script>
      var myDataRef = new Firebase('https://blinding-torch-7040.firebaseio.com/');//My Firebase Data Reference
      $('#submitButton').click(function (e) 
      {
            if ($('#noteTitle').val() != null && $('#noteTask').val() != null) 
            {
                var title = $('#noteTitle').val();
                var description = $('#noteTask').val();
                myDataRef.push({title: title, description: description});
                $('#noteTitle').val('');
                $('#noteTask').val('');
            }
      });
      myDataRef.on('child_added', function(snapshot) //Event Listener when a child has been added
      {
            var note = snapshot.val();
            var key = snapshot.key();
            addNote(note.title, note.description,key);//adds the note to firebase
      });
      myDataRef.on('child_removed', function(snapshot) //Event Listener when a child as been removed
      {
            var note = snapshot.val();
            alert('You Removed:' + note.title);
            $('#' + snapshot.key()).remove();//removes the task from the HTML page
      });
      function addNote(title, description, key) //Function for adding a note to the notepad
      {
            $('#notesDiv').append('<p id = "' + key + '">' + title + ':' + description + '</p>');
            $('#' + key).click(function (e)
            {
                $('#' + key).replaceWith('<p id = "' + key + '"><del>' + title + ':' + description + '</del></p>');//Marks the task as done by putting a line
                $('#' + key).append('<button id= "' + key + 'button">Remove!</button>');//Adds a button that lets the user remove the task permanently
                $('#' + key + "button").click(function (e)
                {
                    myDataRef.child(key).remove();
                });
            });
            $('#notesDiv')[0].scrollTop = $('#notesDiv')[0].scrollHeight;
      };
    </script>
  </body>
</html>